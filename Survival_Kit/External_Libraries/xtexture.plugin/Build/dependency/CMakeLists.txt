include(${CMAKE_BINARY_DIR}/_deps/xcmake_tools/Common.cmake)

# Fetch dependencies
FetchAndPopulate("https://github.com/LIONant-depot/xserializer.git" "main")
FetchAndPopulate("https://github.com/LIONant-depot/xresource_pipeline_v2.git" "main")
FetchAndPopulate("https://github.com/LIONant-depot/xbmp_tools.git" "main")
FetchAndPopulate("https://github.com/BinomialLLC/crunch.git" "master")
FetchAndPopulate("https://github.com/GPUOpen-Tools/compressonator.git" "master")
FetchAndPopulate("https://github.com/BinomialLLC/basis_universal.git" "master")
FetchAndPopulate("https://github.com/LIONant-depot/xstrtool.git" "main" )


# Define crunch
DefineInterfaceComponent(crunch "dependencies/Crunch"
  "crnlib/crnlib.cpp"
  "**crn"
  "crnlib/crn_arealist.cpp"
  "crnlib/crn_assert.cpp"
  "crnlib/crn_checksum.cpp"
  "crnlib/crn_colorized_console.cpp"
  "crnlib/crn_command_line_params.cpp"
  "crnlib/crn_comp.cpp"
  "crnlib/crn_console.cpp"
  "crnlib/crn_core.cpp"
  "crnlib/crn_data_stream.cpp"
  "crnlib/crn_dds_comp.cpp"
  "crnlib/crn_decomp.cpp"
  "crnlib/crn_dxt.cpp"
  "crnlib/crn_dxt_endpoint_refiner.cpp"
  "crnlib/crn_dxt_fast.cpp"
  "crnlib/crn_dxt_hc.cpp"
  "crnlib/crn_dxt_hc_common.cpp"
  "crnlib/crn_dxt_image.cpp"
  "crnlib/crn_dxt1.cpp"
  "crnlib/crn_dxt5a.cpp"
  "crnlib/crn_dynamic_string.cpp"
  "crnlib/crn_etc.cpp"
  "crnlib/crn_file_utils.cpp"
  "crnlib/crn_find_files.cpp"
  "crnlib/crn_hash.cpp"
  "crnlib/crn_hash_map.cpp"
  "crnlib/crn_huffman_codes.cpp"
  "crnlib/crn_image_utils.cpp"
  "crnlib/crn_jpgd.cpp"
  "crnlib/crn_jpge.cpp"
  "crnlib/crn_ktx_texture.cpp"
  "crnlib/crn_lzma_codec.cpp"
  "crnlib/crn_math.cpp"
  "crnlib/crn_mem.cpp"
  "crnlib/crn_miniz.cpp"
  "crnlib/crn_mipmapped_texture.cpp"
  "crnlib/crn_zeng.cpp"
  "crnlib/crn_pixel_format.cpp"
  "crnlib/crn_platform.cpp"
  "crnlib/crn_prefix_coding.cpp"
  "crnlib/crn_qdxt1.cpp"
  "crnlib/crn_qdxt5.cpp"
  "crnlib/crn_rand.cpp"
  "crnlib/crn_resample_filters.cpp"
  "crnlib/crn_resampler.cpp"
  "crnlib/crn_rg_etc1.cpp"
  "crnlib/crn_ryg_dxt.cpp"
  "crnlib/crn_sparse_bit_array.cpp"
  "crnlib/crn_stb_image.cpp"
  "crnlib/crn_strutils.cpp"
  "crnlib/crn_symbol_codec.cpp"
  "crnlib/crn_texture_comp.cpp"
  "crnlib/crn_texture_conversion.cpp"
  "crnlib/crn_texture_file_types.cpp"
  "crnlib/crn_threaded_resampler.cpp"
  "crnlib/crn_threading_pthreads.cpp"
  "crnlib/crn_threading_win32.cpp"
  "crnlib/crn_timer.cpp"
  "crnlib/crn_utils.cpp"
  "crnlib/crn_value.cpp"
  "crnlib/crn_vector.cpp"
  "**lzma"
  "crnlib/lzma_7zBuf.cpp"
  "crnlib/lzma_7zBuf2.cpp"
  "crnlib/lzma_7zCrc.cpp"
  "crnlib/lzma_7zFile.cpp"
  "crnlib/lzma_7zStream.cpp"
  "crnlib/lzma_Alloc.cpp"
  "crnlib/lzma_Bcj2.cpp"
  "crnlib/lzma_Bra.cpp"
  "crnlib/lzma_Bra86.cpp"
  "crnlib/lzma_BraIA64.cpp"
  "crnlib/lzma_LzFind.cpp"
  "crnlib/lzma_LzFindMt.cpp"
  "crnlib/lzma_LzmaDec.cpp"
  "crnlib/lzma_LzmaEnc.cpp"
  "crnlib/lzma_LzmaLib.cpp"
  "crnlib/lzma_Threads.cpp"
)

# Define compressonator
DefineInterfaceComponent(compressonator "dependencies"
  "**applications/_libs"
  "applications/_libs/cmp_math/cmp_math_common.cpp"
  "applications/_libs/cmp_math/cpu_extensions.cpp"
  "applications/_libs/cmp_math/jmlfuncs.cpp"
  "**applications/_plugins/ccmp_encode"
  "applications/_plugins/ccmp_encode/hpc/ccpu_hpc.cpp"
  "applications/_plugins/ccmp_encode/hpc/cmp_hpc.cpp"
  "applications/_plugins/ccmp_encode/hpc/compute_cpu_hpc.cpp"
  "**applications/_plugins/ccmp_sdk"
  "applications/_plugins/ccmp_sdk/bc1/bc1.cpp"
  "applications/_plugins/ccmp_sdk/bc2/bc2.cpp"
  "applications/_plugins/ccmp_sdk/bc3/bc3.cpp"
  "applications/_plugins/ccmp_sdk/bc4/bc4.cpp"
  "applications/_plugins/ccmp_sdk/bc5/bc5.cpp"
  "applications/_plugins/ccmp_sdk/bc6/bc6h.cpp"
  "applications/_plugins/ccmp_sdk/bc7/bc7.cpp"
  "applications/_plugins/ccmp_sdk/bcn.cpp"
  "**applications/_plugins/cimage/dds"
  "applications/_plugins/cimage/dds/dds.cpp"
  "applications/_plugins/cimage/dds/dds_dx10.cpp"
  "applications/_plugins/cimage/dds/dds_file.cpp"
  "applications/_plugins/cimage/dds/dds_helpers.cpp"
  "**applications/_plugins/common"
  "applications/_plugins/common/atiformats.cpp"
  "applications/_plugins/common/cmp_fileio.cpp"
  "applications/_plugins/common/codec_common.cpp"
  "applications/_plugins/common/cpu_timing.cpp"
  "applications/_plugins/common/format_conversion.cpp"
  "applications/_plugins/common/mipstoqimage.cpp"
  "applications/_plugins/common/misc.cpp"
  "applications/_plugins/common/pluginmanager.cpp"
  "applications/_plugins/common/tc_plugininternal.cpp"
  "applications/_plugins/common/texture_utils.cpp"
  "applications/_plugins/common/userinterface.cpp"
  "applications/_plugins/common/utilfuncs.cpp"
  "**cmp_compressonatorlib/apc"
  "cmp_compressonatorlib/apc/apc_decode.cpp"
  "cmp_compressonatorlib/apc/apc_encode.cpp"
  "cmp_compressonatorlib/apc/codec_apc.cpp"
  "**cmp_compressonatorlib/astc"
  "cmp_compressonatorlib/astc/arm/mathlib.cpp"
  "cmp_compressonatorlib/astc/arm/softfloat.cpp"
  "**cmp_compressonatorlib/atc"
  "cmp_compressonatorlib/atc/codec_atc.cpp"
  "cmp_compressonatorlib/atc/codec_atc_rgb.cpp"
  "cmp_compressonatorlib/atc/codec_atc_rgba_explicit.cpp"
  "cmp_compressonatorlib/atc/codec_atc_rgba_interpolated.cpp"
  "**cmp_compressonatorlib/ati"
  "cmp_compressonatorlib/ati/codec_ati1n.cpp"
  "cmp_compressonatorlib/ati/codec_ati2n.cpp"
  "cmp_compressonatorlib/ati/codec_ati2n_dxt5.cpp"
  "cmp_compressonatorlib/ati/codec_ati_tc.cpp"
  "cmp_compressonatorlib/ati/compressonatori_tc.c"
  "cmp_compressonatorlib/ati/compressonatorxcodec.cpp"
  "**cmp_compressonatorlib/basis"
  "cmp_compressonatorlib/basis/codec_basis.cpp"
  "**cmp_compressonatorlib/bc6h"
  "cmp_compressonatorlib/bc6h/bc6h_decode.cpp"
  "cmp_compressonatorlib/bc6h/bc6h_definitions.cpp"
  "cmp_compressonatorlib/bc6h/bc6h_encode.cpp"
  "cmp_compressonatorlib/bc6h/bc6h_library.cpp"
  "cmp_compressonatorlib/bc6h/bc6h_utils.cpp"
  "cmp_compressonatorlib/bc6h/codec_bc6h.cpp"
  "**cmp_compressonatorlib/bc7"
  "cmp_compressonatorlib/bc7/3dquant_vpc.cpp"
  "cmp_compressonatorlib/bc7/bc7_decode.cpp"
  "cmp_compressonatorlib/bc7/bc7_definitions.cpp"
  "cmp_compressonatorlib/bc7/bc7_encode.cpp"
  "cmp_compressonatorlib/bc7/bc7_library.cpp"
  "cmp_compressonatorlib/bc7/bc7_partitions.cpp"
  "cmp_compressonatorlib/bc7/bc7_utils.cpp"
  "cmp_compressonatorlib/bc7/codec_bc7.cpp"
  "cmp_compressonatorlib/bc7/reconstruct.cpp"
  "cmp_compressonatorlib/bc7/shake.cpp"
  "**cmp_compressonatorlib/block"
  "cmp_compressonatorlib/block/codec_block.cpp"
  "cmp_compressonatorlib/block/codec_block_4x4.cpp"
  "cmp_compressonatorlib/block/codec_block_8x8.cpp"
  "**cmp_compressonatorlib/buffer"
  "cmp_compressonatorlib/buffer/codecbuffer.cpp"
  "cmp_compressonatorlib/buffer/codecbuffer_block.cpp"
  "cmp_compressonatorlib/buffer/codecbuffer_r16.cpp"
  "cmp_compressonatorlib/buffer/codecbuffer_r16f.cpp"
  "cmp_compressonatorlib/buffer/codecbuffer_r32.cpp"
  "cmp_compressonatorlib/buffer/codecbuffer_r32f.cpp"
  "cmp_compressonatorlib/buffer/codecbuffer_r8.cpp"
  "cmp_compressonatorlib/buffer/codecbuffer_r8s.cpp"
  "cmp_compressonatorlib/buffer/codecbuffer_rg16.cpp"
  "cmp_compressonatorlib/buffer/codecbuffer_rg16f.cpp"
  "cmp_compressonatorlib/buffer/codecbuffer_rg32.cpp"
  "cmp_compressonatorlib/buffer/codecbuffer_rg32f.cpp"
  "cmp_compressonatorlib/buffer/codecbuffer_rg8.cpp"
  "cmp_compressonatorlib/buffer/codecbuffer_rg8s.cpp"
  "cmp_compressonatorlib/buffer/codecbuffer_rgb888.cpp"
  "cmp_compressonatorlib/buffer/codecbuffer_rgb888s.cpp"
  "cmp_compressonatorlib/buffer/codecbuffer_rgb9995ef.cpp"
  "cmp_compressonatorlib/buffer/codecbuffer_rgba1010102.cpp"
  "cmp_compressonatorlib/buffer/codecbuffer_rgba16.cpp"
  "cmp_compressonatorlib/buffer/codecbuffer_rgba16f.cpp"
  "cmp_compressonatorlib/buffer/codecbuffer_rgba2101010.cpp"
  "cmp_compressonatorlib/buffer/codecbuffer_rgba32.cpp"
  "cmp_compressonatorlib/buffer/codecbuffer_rgba32f.cpp"
  "cmp_compressonatorlib/buffer/codecbuffer_rgba8888.cpp"
  "cmp_compressonatorlib/buffer/codecbuffer_rgba8888s.cpp"
  "**cmp_compressonatorlib/common"
  "cmp_compressonatorlib/common/codec.cpp"
  "cmp_compressonatorlib/compress.cpp"
  "cmp_compressonatorlib/compressonator.cpp"
  "**cmp_compressonatorlib/dxtc"
  "cmp_compressonatorlib/dxtc/codec_dxtc.cpp"
  "cmp_compressonatorlib/dxtc/codec_dxtc_alpha.cpp"
  "cmp_compressonatorlib/dxtc/codec_dxtc_rgba.cpp"
  "cmp_compressonatorlib/dxtc/dxtc_v11_compress.c"
  "cmp_compressonatorlib/dxtc/dxtc_v11_compress_asm.c"
  "**cmp_compressonatorlib/dxt"
  "cmp_compressonatorlib/dxt/codec_dxt1.cpp"
  "cmp_compressonatorlib/dxt/codec_dxt3.cpp"
  "cmp_compressonatorlib/dxt/codec_dxt5.cpp"
  "cmp_compressonatorlib/dxt/codec_dxt5_rbxg.cpp"
  "cmp_compressonatorlib/dxt/codec_dxt5_rgxb.cpp"
  "cmp_compressonatorlib/dxt/codec_dxt5_rxbg.cpp"
  "cmp_compressonatorlib/dxt/codec_dxt5_swizzled.cpp"
  "cmp_compressonatorlib/dxt/codec_dxt5_xgbr.cpp"
  "cmp_compressonatorlib/dxt/codec_dxt5_xgxr.cpp"
  "cmp_compressonatorlib/dxt/codec_dxt5_xrbg.cpp"
  "**cmp_compressonatorlib/etc"
  "cmp_compressonatorlib/etc/codec_etc.cpp"
  "cmp_compressonatorlib/etc/codec_etc2.cpp"
  "cmp_compressonatorlib/etc/codec_etc2_rgb.cpp"
  "cmp_compressonatorlib/etc/codec_etc2_rgba.cpp"
  "cmp_compressonatorlib/etc/codec_etc2_rgba1.cpp"
  "cmp_compressonatorlib/etc/codec_etc_rgb.cpp"
  "cmp_compressonatorlib/etc/codec_etc_rgba_explicit.cpp"
  "cmp_compressonatorlib/etc/codec_etc_rgba_interpolated.cpp"
  "cmp_compressonatorlib/etc/etcpack/etcdec.cxx"
  "cmp_compressonatorlib/etc/etcpack/etcimage.cxx"
  "cmp_compressonatorlib/etc/etcpack/etcpack.cxx"
  "**cmp_compressonatorlib/gt"
  "cmp_compressonatorlib/gt/codec_gt.cpp"
  "cmp_compressonatorlib/gt/gt_decode.cpp"
  "cmp_compressonatorlib/gt/gt_encode.cpp"
  "**cmp_core/shaders"
  "cmp_core/shaders/bc1_encode_kernel.cpp"
  "cmp_core/shaders/bc2_encode_kernel.cpp"
  "cmp_core/shaders/bc3_encode_kernel.cpp"
  "cmp_core/shaders/bc4_encode_kernel.cpp"
  "cmp_core/shaders/bc5_encode_kernel.cpp"
  "cmp_core/shaders/bc6_encode_kernel.cpp"
  "cmp_core/shaders/bc7_encode_kernel.cpp"
  "cmp_core/shaders/brlg_encode_kernel.cpp"
  "**cmp_core/source"
  "cmp_core/source/cmp_core.cpp"
  "cmp_core/source/core_simd_avx.cpp"
  "cmp_core/source/core_simd_avx512.cpp"
  "cmp_core/source/core_simd_sse.cpp"
  "**cmp_framework/common"
  "cmp_framework/common/cmp_boxfilter.cpp"
  "cmp_framework/common/cmp_mips.cpp"
  "cmp_framework/common/half/half.cpp"
  "cmp_framework/common/hdr_encode.cpp"
  "**cmp_framework"
  "cmp_framework/compute_base.cpp"
)
if(compressonator_CREATED)
  AppendComponentIncludes(compressonator
    "${CMAKE_SOURCE_DIR}/dependencies/compressonator/cmp_compressonatorlib"
    "${CMAKE_SOURCE_DIR}/dependencies/compressonator/applications/_plugins/common"
    "${CMAKE_SOURCE_DIR}/dependencies/compressonator/cmp_compressonatorlib/astc/arm"
    "${CMAKE_SOURCE_DIR}/dependencies/compressonator/cmp_framework/common"
    "${CMAKE_SOURCE_DIR}/dependencies/compressonator/cmp_compressonatorlib/bc7"
    "${CMAKE_SOURCE_DIR}/dependencies/compressonator/cmp_compressonatorlib/common"
    "${CMAKE_SOURCE_DIR}/dependencies/compressonator/cmp_framework/common/half"
    "${CMAKE_SOURCE_DIR}/dependencies/compressonator/cmp_core/source"
    "${CMAKE_SOURCE_DIR}/dependencies/compressonator/cmp_compressonatorlib/block"
    "${CMAKE_SOURCE_DIR}/dependencies/compressonator/cmp_compressonatorlib/buffer"
    "${CMAKE_SOURCE_DIR}/dependencies/compressonator/cmp_compressonatorlib/ati"
    "${CMAKE_SOURCE_DIR}/dependencies/compressonator/cmp_compressonatorlib/dxtc"
    "${CMAKE_SOURCE_DIR}/dependencies/compressonator/cmp_core/shaders"
    "${CMAKE_SOURCE_DIR}/dependencies/compressonator/applications/_libs/cmp_math"
    "${CMAKE_SOURCE_DIR}/dependencies/compressonator/cmp_compressonatorlib/etc/etcpack"
    "${CMAKE_SOURCE_DIR}/dependencies/compressonator/cmp_compressonatorlib/dxt"
    "${CMAKE_SOURCE_DIR}/dependencies/compressonator/cmp_compressonatorlib/atc"
    "${CMAKE_SOURCE_DIR}/dependencies/compressonator/cmp_compressonatorlib/etc"
    "${CMAKE_SOURCE_DIR}/dependencies/compressonator/cmp_compressonatorlib/bc6h"
    "${CMAKE_SOURCE_DIR}/dependencies/compressonator/applications/_plugins/common"
    "${CMAKE_SOURCE_DIR}/dependencies/compressonator/cmp_framework"
    "${CMAKE_SOURCE_DIR}/dependencies/zstd/lib"
    "${CMAKE_SOURCE_DIR}/dependencies/stb"
  )
endif()

# Define xtexture_compiler
DefineInterfaceComponent(xtexture_compiler_ "dependencies/xcore"
  "source/xtexture_rsc_descriptor.h"
  "source/Compiler/xtexture_compiler.h"
  "source/Compiler/xtexture_compiler.cpp"
)
if(xtexture_comp_CREATED)
  AppendComponentIncludes(xtexture_compiler_
  )
endif()